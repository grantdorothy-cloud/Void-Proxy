<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Void â€” Web Proxy</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Mono:ital,wght@0,300;0,400;0,500;1,300&family=Syne:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<!-- Scramjet + BareMux scripts served by the Node backend -->
<script src="/baremux/bare.cjs"></script>
<script src="/epoxy/index.js"></script>
<script src="/scram/scramjet.all.js"></script>

<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  :root {
    --bg: #0a0a0f; --surface: #12121a; --surface2: #1c1c28;
    --border: #2a2a3a; --accent: #7c6aff; --accent2: #ff6a9e;
    --text: #e8e8f0; --muted: #6b6b85; --glow: rgba(124,106,255,0.25);
    --green: #4ade80; --yellow: #facc15; --red: #f87171;
  }
  html, body { height: 100%; background: var(--bg); color: var(--text); font-family: 'DM Mono', monospace; overflow: hidden; }
  body::before {
    content: ''; position: fixed; inset: 0; pointer-events: none; z-index: 9999; opacity: 0.35;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.05'/%3E%3C/svg%3E");
  }
  .app { display: flex; flex-direction: column; height: 100vh; }

  /* â”€â”€ TOPBAR â”€â”€ */
  .topbar {
    display: flex; align-items: center; gap: 10px;
    padding: 8px 14px; background: var(--surface);
    border-bottom: 1px solid var(--border); flex-shrink: 0;
    user-select: none;
  }
  .logo {
    font-family: 'Syne', sans-serif; font-weight: 800; font-size: 17px;
    letter-spacing: -0.5px; background: linear-gradient(135deg, var(--accent), var(--accent2));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    white-space: nowrap; user-select: none; min-width: 38px;
  }
  .divider { width: 1px; height: 22px; background: var(--border); flex-shrink: 0; }
  .nav-btn {
    display: flex; align-items: center; justify-content: center;
    width: 30px; height: 30px; border: none; background: transparent;
    color: var(--muted); cursor: pointer; border-radius: 7px;
    transition: color .15s, background .15s; flex-shrink: 0;
  }
  .nav-btn:hover { color: var(--text); background: var(--surface2); }
  .nav-btn:disabled { opacity: 0.25; cursor: default; background: transparent !important; }
  .nav-btn svg { width: 15px; height: 15px; }

  /* URL BAR */
  .url-wrap { flex: 1; position: relative; display: flex; align-items: center; min-width: 0; }
  .url-prefix {
    position: absolute; left: 11px; display: flex; align-items: center;
    pointer-events: none; gap: 5px;
  }
  .url-prefix svg { width: 13px; height: 13px; }
  .lock-open  { color: var(--muted); }
  .lock-closed{ color: var(--green); }
  .url-input {
    width: 100%; height: 34px; padding: 0 72px 0 34px;
    background: var(--surface2); border: 1px solid var(--border);
    border-radius: 9px; color: var(--text); font-family: 'DM Mono', monospace;
    font-size: 12.5px; outline: none; transition: border-color .2s, box-shadow .2s;
  }
  .url-input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px var(--glow); }
  .url-input::placeholder { color: var(--muted); }
  .go-btn {
    position: absolute; right: 5px; height: 24px; padding: 0 12px;
    background: linear-gradient(135deg, var(--accent), #5248e8);
    border: none; border-radius: 6px; color: #fff;
    font-family: 'Syne', sans-serif; font-size: 10.5px; font-weight: 700;
    letter-spacing: .5px; cursor: pointer; transition: opacity .15s, transform .1s;
  }
  .go-btn:hover { opacity: 0.88; } .go-btn:active { transform: scale(0.96); }

  /* â”€â”€ STATUSBAR â”€â”€ */
  .statusbar {
    display: flex; align-items: center; gap: 8px;
    padding: 3px 14px; background: var(--surface);
    border-bottom: 1px solid var(--border); flex-shrink: 0;
    font-size: 10.5px; color: var(--muted); height: 26px;
  }
  .status-dot {
    width: 6px; height: 6px; border-radius: 50%;
    background: var(--muted); transition: background .3s; flex-shrink: 0;
  }
  .status-dot.ok  { background: var(--green); box-shadow: 0 0 5px #4ade8080; }
  .status-dot.busy{ background: var(--yellow); animation: pulse .9s infinite; }
  .status-dot.err { background: var(--red); }
  @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.3} }
  .status-text { flex: 1; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }

  /* â”€â”€ CONTENT â”€â”€ */
  .content-area { flex: 1; position: relative; overflow: hidden; }

  /* HOME */
  .home-screen {
    position: absolute; inset: 0; display: flex; flex-direction: column;
    align-items: center; justify-content: center; gap: 32px;
    background: var(--bg); z-index: 2; padding: 40px;
    transition: opacity .25s;
  }
  .home-screen.hidden { opacity: 0; pointer-events: none; }
  .home-hero { text-align: center; }
  .home-title {
    font-family: 'Syne', sans-serif; font-size: clamp(38px, 7vw, 70px);
    font-weight: 800; line-height: .92; letter-spacing: -3px;
    background: linear-gradient(135deg, var(--text) 0%, var(--muted) 100%);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px;
  }
  .home-title span { background: linear-gradient(135deg, var(--accent), var(--accent2)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
  .home-sub { color: var(--muted); font-size: 11.5px; letter-spacing: .4px; }

  /* INIT BADGE */
  .init-badge {
    display: inline-flex; align-items: center; gap: 8px;
    padding: 7px 14px; border-radius: 20px; font-size: 11px;
    border: 1px solid var(--border); background: var(--surface);
    transition: border-color .3s;
  }
  .init-badge.ready { border-color: var(--green); color: var(--green); }
  .init-badge.loading { border-color: var(--yellow); color: var(--yellow); }
  .init-badge.error { border-color: var(--red); color: var(--red); }
  .init-dot { width: 6px; height: 6px; border-radius: 50%; background: currentColor; }
  .init-badge.loading .init-dot { animation: pulse .9s infinite; }

  /* QUICK LINKS */
  .quick-links { display: grid; grid-template-columns: repeat(auto-fit, minmax(108px,1fr)); gap: 9px; width: 100%; max-width: 570px; }
  .quick-link {
    display: flex; flex-direction: column; align-items: center; gap: 6px;
    padding: 13px 8px; background: var(--surface); border: 1px solid var(--border);
    border-radius: 10px; cursor: pointer; text-decoration: none; color: var(--text);
    font-size: 11px; font-family: 'DM Mono', monospace;
    transition: border-color .2s, background .2s, transform .15s;
  }
  .quick-link:hover { border-color: var(--accent); background: var(--surface2); transform: translateY(-2px); }
  .ql-icon { width: 28px; height: 28px; border-radius: 6px; background: var(--surface2); display: flex; align-items: center; justify-content: center; font-size: 14px; }

  /* INFO */
  .info-row {
    display: flex; align-items: flex-start; gap: 10px; padding: 10px 14px;
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 10px; font-size: 11px; color: var(--muted);
    max-width: 570px; width: 100%; line-height: 1.65;
  }
  .info-row svg { width: 14px; height: 14px; flex-shrink: 0; margin-top: 1px; color: var(--accent); }

  /* IFRAME */
  #proxy-frame {
    position: absolute; inset: 0; width: 100%; height: 100%;
    border: none; background: #fff; z-index: 1;
  }

  /* LOADING OVERLAY */
  .loading-overlay {
    position: absolute; inset: 0; background: var(--bg);
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    gap: 14px; z-index: 3; opacity: 0; pointer-events: none; transition: opacity .2s;
  }
  .loading-overlay.active { opacity: 1; pointer-events: all; }
  .spinner { width: 32px; height: 32px; border: 2px solid var(--border); border-top-color: var(--accent); border-radius: 50%; animation: spin .7s linear infinite; }
  @keyframes spin { to { transform: rotate(360deg); } }
  .load-text { font-size: 11.5px; color: var(--muted); }
  .load-sub   { font-size: 10.5px; color: var(--border); margin-top: -8px; }

  /* ERROR */
  .error-screen {
    position: absolute; inset: 0; display: flex; flex-direction: column;
    align-items: center; justify-content: center; gap: 14px;
    background: var(--bg); z-index: 4; opacity: 0; pointer-events: none;
    transition: opacity .2s; padding: 40px; text-align: center;
  }
  .error-screen.active { opacity: 1; pointer-events: all; }
  .err-code { font-family: 'Syne', sans-serif; font-size: 60px; font-weight: 800; color: var(--accent2); opacity: .2; line-height: 1; }
  .err-title { font-family: 'Syne', sans-serif; font-size: 17px; font-weight: 700; }
  .err-msg { color: var(--muted); font-size: 11.5px; max-width: 400px; line-height: 1.7; }
  .err-btn-row { display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; margin-top: 4px; }
  .err-btn {
    height: 30px; padding: 0 14px; background: var(--surface2);
    border: 1px solid var(--border); border-radius: 7px; color: var(--text);
    font-family: 'DM Mono', monospace; font-size: 11px;
    cursor: pointer; transition: border-color .15s;
  }
  .err-btn:hover { border-color: var(--accent); }

  ::-webkit-scrollbar { width: 5px; }
  ::-webkit-scrollbar-track { background: var(--bg); }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
</style>
</head>
<body>
<div class="app">

  <!-- TOPBAR -->
  <div class="topbar">
    <div class="logo">void.</div>
    <div class="divider"></div>
    <button class="nav-btn" id="btn-back" disabled title="Back">
      <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M19 12H5M12 5l-7 7 7 7"/></svg>
    </button>
    <button class="nav-btn" id="btn-forward" disabled title="Forward">
      <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M5 12h14M12 19l7-7-7-7"/></svg>
    </button>
    <button class="nav-btn" id="btn-refresh" title="Refresh / Stop">
      <svg id="icon-refresh" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M4 4v5h5"/><path d="M20 20v-5h-5"/><path d="M4 9a9 9 0 0 1 15-4.243M20 15a9 9 0 0 1-15 4.243"/></svg>
      <svg id="icon-stop" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" style="display:none"><rect x="6" y="6" width="12" height="12" rx="2"/></svg>
    </button>
    <button class="nav-btn" id="btn-home" title="Home">
      <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9,22 9,12 15,12 15,22"/></svg>
    </button>
    <div class="divider"></div>
    <div class="url-wrap">
      <span class="url-prefix" id="url-prefix">
        <!-- icon swapped by JS -->
        <svg class="lock-open" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" id="icon-search"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
        <svg class="lock-closed" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24" id="icon-lock" style="display:none"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
      </span>
      <input class="url-input" id="url-input" type="text" placeholder="Search or enter a URLâ€¦" autocomplete="off" spellcheck="false"/>
      <button class="go-btn" id="btn-go">GO</button>
    </div>
  </div>

  <!-- STATUSBAR -->
  <div class="statusbar">
    <div class="status-dot" id="status-dot"></div>
    <span class="status-text" id="status-text">Initializing Scramjetâ€¦</span>
  </div>

  <!-- CONTENT -->
  <div class="content-area">

    <!-- HOME SCREEN -->
    <div class="home-screen" id="home-screen">
      <div class="home-hero">
        <div class="home-title">browse <span>free.</span></div>
        <div class="home-sub">powered by scramjet Â· service worker interception Â· full js support</div>
      </div>

      <!-- Init status badge -->
      <div class="init-badge loading" id="init-badge">
        <div class="init-dot"></div>
        <span id="init-badge-text">Initializing Scramjet service workerâ€¦</span>
      </div>

      <div class="quick-links">
        <a class="quick-link" data-url="https://www.google.com"><div class="ql-icon">ğŸ”</div>Google</a>
        <a class="quick-link" data-url="https://www.youtube.com"><div class="ql-icon">â–¶ï¸</div>YouTube</a>
        <a class="quick-link" data-url="https://www.wikipedia.org"><div class="ql-icon">ğŸ“–</div>Wikipedia</a>
        <a class="quick-link" data-url="https://news.ycombinator.com"><div class="ql-icon">ğŸ”¶</div>HN</a>
        <a class="quick-link" data-url="https://www.reddit.com"><div class="ql-icon">ğŸ¤–</div>Reddit</a>
        <a class="quick-link" data-url="https://github.com"><div class="ql-icon">ğŸ™</div>GitHub</a>
        <a class="quick-link" data-url="https://discord.com/app"><div class="ql-icon">ğŸ’¬</div>Discord</a>
        <a class="quick-link" data-url="https://www.twitch.tv"><div class="ql-icon">ğŸŸ£</div>Twitch</a>
        <a class="quick-link" data-url="https://www.spotify.com"><div class="ql-icon">ğŸµ</div>Spotify</a>
        <a class="quick-link" data-url="https://stackoverflow.com"><div class="ql-icon">ğŸ“š</div>Stack OF</a>
      </div>

      <div class="info-row">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 8v4M12 16h.01"/></svg>
        <span><strong>Scramjet</strong> is an interception-based service worker proxy â€” it rewrites and tunnels full web pages including JavaScript, bypassing restrictions. Supports Google, YouTube, Discord, Spotify, Reddit, and more.</span>
      </div>
    </div>

    <!-- Proxy iframe â€” Scramjet rewrites URLs to go through the SW -->
    <iframe id="proxy-frame" style="display:none" allow="fullscreen; autoplay; clipboard-read; clipboard-write"></iframe>

    <!-- Loading -->
    <div class="loading-overlay" id="loading-overlay">
      <div class="spinner"></div>
      <div class="load-text" id="load-text">Loadingâ€¦</div>
      <div class="load-sub"  id="load-sub"></div>
    </div>

    <!-- Error -->
    <div class="error-screen" id="error-screen">
      <div class="err-code">ERR</div>
      <div class="err-title">Something went wrong</div>
      <div class="err-msg" id="err-msg">The page could not be loaded.</div>
      <div class="err-btn-row">
        <button class="err-btn" id="err-newtab">Open in New Tab â†—</button>
        <button class="err-btn" id="err-retry">Retry</button>
        <button class="err-btn" onclick="showHome()">â† Home</button>
      </div>
    </div>

  </div>
</div>

<script>
// â”€â”€â”€ Scramjet config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// These paths are served by the Node.js backend from node_modules
const SCRAM_CONFIG = {
  prefix:  '/scram/service/',   // all proxied URLs go under this path
  files: {
    wasm:  '/scram/scramjet.wasm.wasm',
    all:   '/scram/scramjet.all.js',
    sync:  '/scram/scramjet.sync.js',
  }
};
const BAREMUX_WORKER = '/baremux/worker.js';
const EPOXY_TRANSPORT = '/epoxy/index.mjs';
const WISP_SERVER = location.origin.replace(/^http/, 'ws') + '/wisp/';

// â”€â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let scramjetReady = false;
let navHistory = [], navIndex = -1, currentUrl = '';
let isLoading = false;

// â”€â”€â”€ Elements â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const urlInput   = document.getElementById('url-input');
const btnGo      = document.getElementById('btn-go');
const btnBack    = document.getElementById('btn-back');
const btnForward = document.getElementById('btn-forward');
const btnRefresh = document.getElementById('btn-refresh');
const btnHome    = document.getElementById('btn-home');
const frame      = document.getElementById('proxy-frame');
const homeScreen = document.getElementById('home-screen');
const loadOvl    = document.getElementById('loading-overlay');
const loadText   = document.getElementById('load-text');
const loadSub    = document.getElementById('load-sub');
const errScr     = document.getElementById('error-screen');
const errMsg     = document.getElementById('err-msg');
const statusDot  = document.getElementById('status-dot');
const statusTxt  = document.getElementById('status-text');
const iconRefresh= document.getElementById('icon-refresh');
const iconStop   = document.getElementById('icon-stop');
const initBadge  = document.getElementById('init-badge');
const initBadgeTxt=document.getElementById('init-badge-text');
const iconSearch = document.getElementById('icon-search');
const iconLock   = document.getElementById('icon-lock');

// â”€â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function setStatus(state, text) {
  statusDot.className = 'status-dot' + (state ? ' '+state : '');
  statusTxt.textContent = text;
}
function setLoadUI(on, text='', sub='') {
  isLoading = on;
  loadOvl.classList.toggle('active', on);
  iconRefresh.style.display = on ? 'none' : '';
  iconStop.style.display    = on ? '' : 'none';
  if (on) { loadText.textContent = text; loadSub.textContent = sub; }
}
function updateLock(url) {
  const https = url && url.startsWith('https://');
  iconSearch.style.display = https ? 'none' : '';
  iconLock.style.display   = https ? '' : 'none';
}
function updateNavBtns() {
  btnBack.disabled    = navIndex <= 0;
  btnForward.disabled = navIndex >= navHistory.length - 1;
}
function normalizeUrl(raw) {
  raw = raw.trim();
  if (!raw) return null;
  if (/^localhost(:\d+)?(\/|$)/.test(raw)) return 'http://' + raw;
  if (/^(\d{1,3}\.){3}\d{1,3}/.test(raw))  return 'http://' + raw;
  if (!/^https?:\/\//i.test(raw)) {
    if (/^[a-z0-9-]+(\.[a-z]{2,})+/i.test(raw)) return 'https://' + raw;
    return 'https://www.google.com/search?q=' + encodeURIComponent(raw);
  }
  return raw;
}
function showHome() {
  homeScreen.classList.remove('hidden');
  frame.style.display = 'none';
  errScr.classList.remove('active');
  setLoadUI(false);
  urlInput.value = ''; currentUrl = '';
  updateLock('');
  setStatus('ok', scramjetReady ? 'Scramjet ready' : 'Initializingâ€¦');
  updateNavBtns();
}
function showError(msg) {
  setLoadUI(false);
  errScr.classList.add('active');
  errMsg.textContent = msg;
  setStatus('err', 'Error: ' + msg);
}

// â”€â”€â”€ Scramjet init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function initScramjet() {
  setStatus('busy', 'Initializing Scramjetâ€¦');
  try {
    // Register the service worker
    const reg = await navigator.serviceWorker.register('/sw.js', { scope: '/' });
    await navigator.serviceWorker.ready;

    // Init ScramjetController
    const { ScramjetController } = $scramjetLoadController();
    const sj = new ScramjetController(SCRAM_CONFIG);
    await sj.init('/sw.js');

    // Init BareMux + Epoxy transport (tunnels through the Wisp server on the backend)
    const conn = new BareMux.BareMuxConnection(BAREMUX_WORKER);
    await conn.setTransport(EPOXY_TRANSPORT, [{ wisp: WISP_SERVER }]);

    scramjetReady = true;
    initBadge.className = 'init-badge ready';
    initBadgeTxt.textContent = 'Scramjet ready â€” full proxy active';
    setStatus('ok', 'Scramjet ready');
    console.log('[Void] Scramjet initialized successfully');
  } catch(e) {
    console.error('[Void] Scramjet init failed:', e);
    initBadge.className = 'init-badge error';
    initBadgeTxt.textContent = 'Scramjet failed: ' + e.message;
    setStatus('err', 'Scramjet init failed â€” is the server running?');
  }
}

// â”€â”€â”€ Navigate â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function navigate(rawUrl, addToHistory = true) {
  const url = normalizeUrl(rawUrl);
  if (!url) return;

  if (!scramjetReady) {
    showError('Scramjet is not ready yet. Wait a moment and try again.');
    return;
  }

  currentUrl = url;
  urlInput.value = url;
  updateLock(url);
  homeScreen.classList.add('hidden');
  errScr.classList.remove('active');
  frame.style.display = 'block';
  setLoadUI(true, 'Loading via Scramjetâ€¦', url);
  setStatus('busy', url);

  if (addToHistory) {
    navHistory = navHistory.slice(0, navIndex + 1);
    navHistory.push(url);
    navIndex++;
  }
  updateNavBtns();

  // Scramjet encodes the URL and routes it through the service worker
  const proxied = SCRAM_CONFIG.prefix + encodeURIComponent(url);

  frame.onload = () => {
    setLoadUI(false);
    // Try to read actual URL back from the frame
    let displayUrl = url;
    try { displayUrl = decodeURIComponent(frame.contentWindow.location.pathname.replace(SCRAM_CONFIG.prefix, '')); } catch {}
    setStatus('ok', displayUrl);
    urlInput.value = displayUrl;
    updateLock(displayUrl);
  };

  frame.onerror = () => {
    showError('Failed to load page through Scramjet.');
  };

  frame.src = proxied;
}

// â”€â”€â”€ Events â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
btnGo.addEventListener('click', () => navigate(urlInput.value));
urlInput.addEventListener('keydown', e => { if(e.key==='Enter') navigate(urlInput.value); });
urlInput.addEventListener('focus', () => urlInput.select());

btnBack.addEventListener('click', () => {
  if(navIndex > 0) { navIndex--; updateNavBtns(); navigate(navHistory[navIndex], false); }
});
btnForward.addEventListener('click', () => {
  if(navIndex < navHistory.length-1) { navIndex++; updateNavBtns(); navigate(navHistory[navIndex], false); }
});
btnRefresh.addEventListener('click', () => {
  if(isLoading) {
    frame.src = ''; setLoadUI(false); setStatus('ok','Stopped.');
  } else if(navIndex >= 0) { navigate(navHistory[navIndex], false); }
});
btnHome.addEventListener('click', showHome);

document.querySelectorAll('.quick-link').forEach(l => {
  l.addEventListener('click', e => { e.preventDefault(); navigate(l.dataset.url); });
});

document.getElementById('err-newtab').onclick = () => window.open(currentUrl, '_blank');
document.getElementById('err-retry').onclick   = () => navigate(currentUrl, false);

// â”€â”€â”€ Boot â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if ('serviceWorker' in navigator) {
  initScramjet();
} else {
  initBadge.className = 'init-badge error';
  initBadgeTxt.textContent = 'Service Workers not supported in this browser';
  setStatus('err', 'Service Workers not supported');
}
</script>
</body>
</html>
